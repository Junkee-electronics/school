clc;
close all;
clear;

hold on;

load prech_char04.mat;

plot(t,y,"g:");

%find the first derivation
gr = gradient(y,t);

%find the point of inflexion
M=max(abs(gr));
Mind=find(abs(gr)==max(abs(gr))); 

f=M*t-y(Mind);

X0ind=find((-0.01<=f)&(f<=0.01));
X0=t(X0ind(1));

X1ind=find((0.99<=f)&(f<=1.01));
X1=t(X1ind(1));

Xinflex = Mind * t(2)-t(1);



plot(t,M*t-y(Mind))
plot(t,gr*25,"r--");
legend;
